# 甜甜圈教程

本教程基于 Blender 3.0 


## 基础形状

1. 新建一个圆柱体 Shift + A
    - 尺寸: 这里采用的是(32, 18, 02, 0.12)
    - F9 可以回显 上一步操作的 数据面板
    - 添加表面 `细分修改器`

2. 进入 `编辑模式` 对甜甜圈形状做 `优化`
    - 开启 `点模式` 开启 `衰减模式` 
    - 选中点 按 G 移动点，可通过 F 调节笔刷大小
    - ...分钟后，甜甜基本形状做好(友情提示-可以框选多个点调整)
    - 开启 `透视模式` 框选上半部分点
    - Shift + D 复制 选中的点(网格), 注：不要移动
    - 按 P 分离，就得到了*糖衣*

3. 对糖衣添加 `实体化修改器` 厚度: 0.01，偏移量: 1，可调
    - 调整 `实体化修改器` 位置为修改器列表最上面
    - 编辑 *糖衣* 开启 `点模式`、`衰减`、`吸附`
    - `吸附` 选为 **面** 选中 **投影到自身** 和 **项目的独立元素**
    - 拖拽 *糖衣* 点 参考网络图片做出 *糖衣* 下垂效果 
    - 做 水滴效果 需要先对需要做水滴的点两边的循环边做环切(省事可以整体做细分)
    - 注；细分不要超过 3级
    - 选中水滴两边的点 按 E 挤出水滴

4. 对面圈做中间凹槽和底部形状优调
    - 选中 *糖衣* 按 H 隐藏(Alt + H 显示) 或者 物体集合面板 小眼睛关闭
    - 选中 *面圈* 进入 `编辑模式`
    - 按 Alt + 鼠标左键 选中 `循环边` 按 S 缩放(可用x,y方向)
    - 调整 *糖衣* 底部形状
    - 此时 *糖衣* 和 *面圈* 之间会有 间隙

5. 对 *糖衣* 添加 `缩裹修改器`
    - 选中物体为 *糖衣*
    - 调整 `缩裹修改器` 到修改器列表最上放
    - 选中 *糖衣* 及 *面圈* Shift + L 绑定父子关系

## 雕刻精修

1. 对 糖衣所有的 修改器 应用 
2. 进入 `雕刻模式` 
    - F 画笔尺寸， Shift + F 画笔强度
    - 应用的功能有，G 抓取、S 光滑，I 膨胀
    - 注：膨胀，笔刷设置 -> 画笔 -> 描边方法 -> 喷枪 
    这样可以通过鼠标点的方式膨胀一个部分
    - 没啥可讲的，需要自己多加尝试练习

## 渲染

1. 相机对齐到当前视角 
    - 对齐Crtl + Alt + 0(数字键)
	  - 视图 -> 摄像机 -> 设置活动物体为摄像机 
	  - 或者选中相机 -> 设为 活动摄像机
	  - 打开 N 面板 视图 -> 视图锁定 -> 锁定相机到视图方位 
	  - Alt + G 将选中的物体吸附到世界原点
    - 渲染模式 有 Eevee 和 Cycles 
    - Cycles 带有光追效果更真实，同时 风扇更响，温度更高，时间更长
    - Eevee 不带光追效果一般，但速度更快
    - 采样 渲染 和 视图 设置越大速度越慢
    - 视图降噪 开启 效果会好点

## 材质，纹理

1. *糖衣* 添加材质
    - 注：一下操作都是选中 *糖衣* 状态
    - `属性面板` `材质属性` 选项 
    - 添加材质槽，
	  - 基础色，次表面(透光度)，粗糙，高光
    - 
2. *面圈* 添加材质
    - 注：一下操作都是选中 *面圈* 状态
    - `属性面板` `材质属性` 选项
    - 添加材质槽，切换到 顶部菜单 `Shading` 节点编辑
    - 添加一个节点 `纹理` -> `图片纹理` 快捷键 *Shift + A* 或节点面板顶部 *添加*
    - `图片纹理` 参数设置 如下：[参数图片]("./img/donuts/pic_wen_li.png")
    - 切换 顶部菜单 `Texture Paint` 纹理绘制
    - 绘制甜甜圈 中间部位 白色分割带
    - 左边视图为 物体展开的 UV贴图 可以在 UV贴图 或者 3D物体 上编辑，UV贴图区 可以采用 `图片编辑器` 下的 `图像绘制` 
    - 绘制好之后切换回 `Shading` 工作区
    - 添加节点 `矢量` -> `凸凹` 的 *法向* 链接到 `原理化BSDF`的 *法向*
    - 添加节点 `纹理` -> `噪波纹理` *系数* 链接到 `凸凹` 的 *高度* 
    - 添加 `颜色` -> `混合RGB` 切换混合模式为 *正片叠加* 链接到 `图片纹理` 和 `原理化BSDF` 之间 *色彩2* 链接 `噪波纹理` 的 *系数* 可以混合 系数
    - 添加节点 `输入` -> `纹理坐标` 其 *物体* 链接到 `噪波纹理` 的 *矢量*
    - 所有节点如下：[所有节点图片]("./img/donuts/mian_quan_wen_li.png")

## 几何节点

1. 糖针制作
    - 选中 *糖衣* 切换到顶部窗口 `Ceometry Nodes` 
    - 在下面 节点编辑器 中点击 `新建`
    - 添加节点 `点` -> `点分布于面上` 调整密度
    - 添加节点 `实例` -> `实例化与点上`
    - 添加节点 `几何数据` -> `合并几何` 分别将 几何数据 链接对应的 *组输出* *组输入* 及 *实例化与点上* 的实例
    如图：[图片]("./img/donuts/ji_he.png")
    - 添加节点 `输入` -> `物体信息` 并将 *几何数据* 链接到 `实例化与点上` 的 *实例*
    - 创建 *糖针* 实例，新建一个正方体修改尺寸 x,y:0.01,z:0.1, 添加 `表面细分` 1级
    - 为 `物体信息` 节点，绑定 *糖针*，点击吸管，选择新建的 *糖针*，调整 *糖针* 方向，
    - 可能遇到的问题 
        1. *糖针* 的方向 和 *糖衣* 上的方向不一致，原因：*糖针* 变换之后没有应用 Ctrl + A 应用 对应的变换
        2. *糖针* 为贴合 糖衣表面 原因1: 未将 `分布点于面上` 的*旋转*与 `实例化与点上` 的*旋转*相连；
        原因2: *糖针*的 原点 不在*糖针* 几何中心，解决：选中*糖针* 右键 `设置原心` -> `几何中心 -> 原点`
    - 添加节点 `实用工具` -> `欧拉旋转` 到 `分布点于面上` 的*旋转*与 `实例化与点上` 的*旋转* 之间，可以调整三个坐标值看看效果
    - 添加节点 `实用工具` -> `随机值` 链接到 `欧拉旋转` 的 `旋转轴`, 修改*随机数*的类型为*矢量*
    - **注意**：`随机值` 矢量 下的值是 PI（圆周率）及 n*PI 输入：pi 或 2*pi
    - 下图为当前 所有节点：[节点图片]("./img/donuts/ji_he2.png")
    - 移除 *糖衣* 水滴上的 *糖针* 
    - 修改 `权重绘制` 模式，F 调整画笔的 大小， Shift + F 调整画笔 强度，绘制权重分布区，蓝色未不分布，红色分布，其余颜色按比例分布
    - 连接 `组输入` 和 `分布点于面上` 的 *密度* 
    - 添加节点 `实用工具` -> `运算` 到 `组输入` 和 `分布点于面上` 的 *密度* 之间
    - 连接 `运算` 的 *值(明度)* 到`组输入`，并修改值
    - 对应关系如下： [对应关系图片]("./img/donuts/ji_he3.png")
    - 上面操作会有穿模等问题，修改 `分布点于面上` 分布方式为 *泊松盘* 调整 *距离最小值* 和 *密度最大值*
    - 原 `运算` 节点删除
    - 注：可以通过 `分布点于面上` 的*随机种* 调整 *糖针* 的分布
    - 所有节点图： [几何节点图片]("./img/donuts/ji_he6.png")
    
## 色彩

1. 为糖针添加颜色
    - 选中 *糖针* 切换 `Shading` 窗口
    - 修改 *糖针* 颜色
    - 复制 *糖针* 多创建几个 *糖针*，并调整各个 *糖针* 大小，使其不同
    - 在大纲 场景中 选中所有 *糖针* 新建集合，把所有糖针放入几何
    - 注：为多个物体指定相同*材质A*可以 选中要所有物体，最后选中*材质A*物体，按 Ctrl + L *关联* -> *关联材质*

2. 修改 *糖衣* 中糖针 
    - 选中 *糖衣* 切换到顶部窗口 `Ceometry Nodes` 
    - 添加节点 `输入` -> `集合信息`
    - 修改 *糖衣* 中 `实例化于点上` 中的*实例*节点 `物体信息` 为 `集合信息`
    - 修改值 为 *糖衣* 集合，勾选 分离子级，重置子级

3. 为糖针设置不同颜色
    - 选中 *糖针* 切换 `Shading` 窗口
    - 添加节点 `输入` -> `物体信息`，连接 `物体信息` 的 *随机* 到 `原理化BSDF` 的 *基础色*
    - 添加节点 `转化器` -> `颜色渐变` 到 `物体信息` 的 *随机* 和 `原理化BSDF` 的 *基础色* 之间
    - 添加 `颜色渐变` 颜色断点，修改两点之间算法为 *常值*，为每个断点指定颜色

    - 恭喜制作一个独一无二甜甜圈了